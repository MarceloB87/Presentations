<html lang="" xml:lang="">
  <head>
    <title>Estimate of the instantaneous reproduction number (R_{t}) of an ongoing epidemic</title>
    <meta charset="utf-8" />
    <meta name="author" content=" Rafael Lopes Paixão da Silva" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <script src="libs/xaringanExtra-webcam/webcam.js"></script>
    <script id="xaringanExtra-webcam-options" type="application/json">{"width":"200","height":"200","margin":"1em"}</script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Estimate of the instantaneous reproduction number (<span class="math inline"><em>R</em><sub><em>t</em></sub></span>) of an ongoing epidemic
## Incorporating nowcasting and back-projection corrections
### <br>Rafael Lopes Paixão da Silva
### October, 27th, 2021

---

background_image: url(https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/Logo_SUS.svg/279px-Logo_SUS.svg.png)





<div>
<style type="text/css">.xaringan-extra-logo {
width: 110px;
height: 128px;
z-index: 0;
background-image: url(fig/oc.jpeg);
background-size: contain;
background-repeat: no-repeat;
position: absolute;
top:1em;right:1em;
}
</style>
<script>(function () {
  let tries = 0
  function addLogo () {
    if (typeof slideshow === 'undefined') {
      tries += 1
      if (tries < 10) {
        setTimeout(addLogo, 100)
      }
    } else {
      document.querySelectorAll('.remark-slide-content:not(.title-slide):not(.inverse):not(.hide_logo)')
        .forEach(function (slide) {
          const logo = document.createElement('div')
          logo.classList = 'xaringan-extra-logo'
          logo.href = null
          slide.appendChild(logo)
        })
    }
  }
  document.addEventListener('DOMContentLoaded', addLogo)
})()</script>
</div>

.pull-left[

# How we are?

The "Observatório COVID19-BR" it is a __independent iniciative__ constructed by __voluntary work and collaboration__, searching to contribute to __scientific analysis__ and to the __public debate__ on the pandemic of SARS-COV2 in Brazil

]

--

.pull-right[

# On this work

+ __Flávia Maria Darci Marquitti__
+ Henrique dos Santos Flores
+ Marcelo Eduardo Borges
+ Tatiana Pineda Portella
+ Silas Poloni Lyra
+ Diogo Melo
+ Renato Mendes Coutinho
+ Paulo Inácio K. L. Prado
+ Roberto André Kraenkel

]

---

# Basic reproduction number (R0)

+ `\(R_0\)` is the basic number (ratio) of reproduction and it characterizes the transmission potential of a disease

--

+ It represents __expected__ number of secondary cases produced by a typical primary case in an entirely __susceptible__ population

--

+ The `\(R_0\)` of a disease is function of human __social behavior__ and organization, as well as the innate __biological__ characteristics of particular pathogens:
 - __Transmissibility__
 - __Contact rate__
 - __Infectious period__

--

+ Constant review
  - Measles: estimate: 12-18
  - Systematic review by Guerra et al (2017):  3-200 (!!)

---

## Instantaneous (effective) reproduction number (Rt ,Reff)

&lt;br /&gt;
`\(R_t\)` is the actual average number of secondary cases per primary case and it is usually a fraction of the `\(R_0\)`: 

--

.center[

  `$$R_t = R_0 X$$`
]

--

where, in a simple model, `\(X\)` is the frequency of __susceptible__ individuals in a population at a given time t
 
---

## Why calculate Reff?

&lt;br /&gt;
It is commonly used to characterize pathogen __transmissibility__ during an epidemic. &lt;br /&gt;

--
&lt;br /&gt;
The monitoring of R over time provides feedback on the __effectiveness__ of interventions and on the need to intensify control efforts.
&lt;br /&gt;
--
&lt;br /&gt;
To stop an epidemic, R needs to be __persistently__ reduced to a level below 1.
&lt;br /&gt;
---

## (effective) reproduction number (Rt ,Reff)

&lt;br /&gt;
Important values of `\(R_{eff}\)`:
&lt;br /&gt;

.center[

 `\(R_{eff} &gt; 1\)`:  number of new cases __increases__ &lt;br /&gt;
 `\(R_{eff} = 1\)`:  equilibrium of number of cases (__endemic__) &lt;br /&gt;
 `\(R_{eff} &lt; 1\)` : number of new cases __decreases__ &lt;br /&gt;
]


--

&lt;br /&gt;
__Reff (and R0) is not a rate!
  It is a number, a ratio.__
&lt;br /&gt;
--
&lt;br /&gt;
Estimate the Reff for a local community, where contacts/transmissions occur

---

## How to estimate the Reff?

Ratio between the incidence number of new cases at a time t and the incidence number of new cases  at time t-1:

&lt;img src="fig/tabela_reff.png" width="800" style="display: block; margin: auto;" /&gt;

However we must consider that the expected number of incidence cases at a given time __t__ depends on the number of incidence cases in previous time steps __t-s__ weighted an infectivity function __ws__

`$$E[I_t] = R_t\sum_{s=1}^{t}I_{t-s}w_s$$`

---

## Database and dates

There are 3 important dates for a given case: 

&lt;img src="fig/timeline.png" width="800" style="display: block; margin: auto;" /&gt;

Brazilian national health surveillance of hospitalized individuals (SIVEP-Gripe) we have
access to at least 2 of them:
  - Date of onset of first symptons
  - Reporting date
  
---

## Correcting delays

How to correct each part of the timeline events on notification system:

&lt;img src="fig/timeline2.png" width="800" style="display: block; margin: auto;" /&gt;

---

## Correcting delays

In our [site](https://covid19br.github.io), we go until 1st symptons date corrections:

&lt;img src="fig/timelineobs.png" width="800" style="display: block; margin: auto;" /&gt;

---

## Methods to estimate `\(R_{eff}\)`

There are several methods to calculate `\(R_{eff}\)`, the most known are:

- Robert Koch Institute 2020

- Wallinga &amp; Teunis 2004

- Bettencourt &amp; Ribeiro 2008

- Cori et al 2013

--
  + Time series of cases
  + Serial interval distribution (transmission tree) - Incorporates uncertainty in the distrbitution the time between onset of symptons in a primary case and the onset of symptons in a secondary case.
  
---

## Reff Observatório

We calculate the `\(R_{eff}\)` by Cori et al, incorporating the nowcasting in the workflow:

&lt;img src="fig/timelineobs.png" width="800" style="display: block; margin: auto;" /&gt;

---

## Nowcasting

Nowcasting estimates the number of cases that have already occurred (that already
have a 1st day of symptoms) but not yet been reported in the database, a forecasting for now:

&lt;img src="fig/nowcasting.png" width="600" style="display: block; margin: auto;" /&gt;

---

## Nowcasting

Nowcasting estimates the number of cases that have already occurred (that already
have a 1st day of symptoms) but not yet been reported in the database, a forecasting for now:
--

.pull-left[
&lt;img src="fig/nowcasting2.png" width="600" style="display: block; margin: auto;" /&gt;
]

.pull-right[
 
+ Nowcasting by Bayesian Smoothing (McGough et al. 2020)
 
+ Posteriors series
 
]

---

## Back-projection

Back-projection estimates the number of cases by infection date, therefore including the incubation period (SARS-CoV2 ~ 5 days)

&lt;img src="fig/backprojection.png" width="600" style="display: block; margin: auto;" /&gt;

---

## Back-projection

Back-projection estimates the number of cases by infection date, therefore including the incubation period (SARS-CoV2 ~ 5 days)

.pull-left[
&lt;img src="fig/backprojection.png" width="600" style="display: block; margin: auto;" /&gt;
]

.pull-right[

+ Expectation-Maximization Smoothing (Becker et al 1991)

+ Bootstrap from the Serial Interval distribution 

&lt;img src="fig/serial2.png" width="400" style="display: block; margin: auto;" /&gt;

]

---

## Credible intervals of the Reff

+ Nowcasting CI: delays from de reporting system

+ Backprojetion CI: delay from the incubation period.

+ Transmission tree CI: from the method proposed by Cori et al 2013 based on cases
that will come from the transmission tree

---

## Different delay corrections

&lt;img src="fig/decisiontree.png" width="800" style="display: block; margin: auto;" /&gt;

---
class: middle

## Results

+ SIVEP-Gripe (hospitalized cases)

+ Positive cases diagnosed by RT-PCR

+ Base from May 18,2020 (with a consolidated base of June 30,2020)

+ State capitals:
  São Paulo (SP), Rio de Janeiro (RJ), Manaus (AM), Fortaleza (CE)

---
class: hide_logo

.pull-left[
&lt;img src="fig/up_all.png" width="800" height="600" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="fig/bottom_all.png" width="800" height="600" style="display: block; margin: auto;" /&gt;
]

---

## Validation

&lt;img src="fig/NowBacknow_sp.png" width="600" style="display: block; margin: auto;" /&gt;

---

## Discussion

+ Estimate the Rt based on the notification date is not accurate

+ Important delays that can be corrected: reporting system and incubation period

+ Backprojection can affect the end of the Rt time series, decreasing the Rt values due to
the lack of data feeding the end of the time series

+ The nowcasting increases the CI of the Rt

---

## Discussion

+ Decisions made by policy makers and health authorities must consider the CI and not
only the mean value. The entire range of the CI must be lower than 1 to be considered
controlled.

+ When using the back-projection correction, one should avoid using the most recent
estimates of Rt (final temporal series).

+ Other metrics should also be taken into account for public health decisions.
values of Rt around 1 associated with a high number of new cases per day can easily fuel a new rise

---

class: middle, center

# Questions?

---
class: middle, center
# Thank You!
# ¡Gracias!
# Obrigado!

<svg aria-hidden="true" role="img" viewBox="0 0 576 512" style="height:1em;width:1.12em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"/></svg> Página web: [https://covid19br.github.io/](https://covid19br.github.io/)
<svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> GitHub: [https://github.com/covid19br/](https://github.com/covid19br/)
<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"/></svg>  [obscovid19br@gmail.com](mailto:obscovid19br@gmail.com)
<svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg> Instagram: [@obscovid19br](www.instagram.com/obscovid19br)
<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> Twitter: [@obscovid19br](www.twitter.com/obscovid19br)
<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>  [https://www.facebook.com/obscovid19br](https://www.facebook.com/obscovid19br)

---
class: inverse

---

## Reff estimate

+ We use a modified estimate_R function from EpiEstim R package

+ We use a sliding window of 6 days

+ Serial interval by Nishiura et al 2020 for MCMC estimation for the
transmission tree

---

## Nowcasting

+ We use a modified function from the NobBs R package (McGough et
al 2020)

+ Trim of 5 days in the time series end

+ Time window of delay:
São Paulo (SP): 70 days
Manaus (AM): 60 days.
Rio de Janeiro (RJ) and Fortaleza (CE) no window.

---

## Nowcasting

&lt;img src="fig/sp_nowcasting.png" width="800" style="display: block; margin: auto;" /&gt;

---

## Nowcasting

&lt;img src="fig/rio_nowcasting.png" width="800" style="display: block; margin: auto;" /&gt;

---

## Nowcasting

&lt;img src="fig/manaus_nowcasting.png" width="800" style="display: block; margin: auto;" /&gt;

---

## Nowcasting

&lt;img src="fig/fortaleza_nowcasting.png" width="800" style="display: block; margin: auto;" /&gt;

---

## Back-projection

class: middle

+ The incidence data is corrected by discounting delays from infection
to the first day of symptoms using an incubation distribution defined
by a lognormal (mean=5.2 days and 95% CI = [4.1, 7.0] days (He et al
2020).

+ In contrast to the nowcasting method, which includes cases
considering the delay of the notification system, the
back-projection method just estimate the shift in the time series
backwards with no addition of cases

---

## Back-projection

class: middle

+ The Expectation-Maximization-Smoothing procedure of Becker et al (1991}
gives a sample estimation of the mean number of individuals infected at
time t and is denoted by λt.

+ The sample estimation must be accompanied by a confidence interval
which can be estimated by a bootstrap method (see Yip 2008).

+ We choose to return a sample draw from a Poisson distribution with mean
λt after we have back-projected our data.

---

## Back-projection

class: middle

+ This procedure is repeated for 1,000 posterior nowcasted series. The
sample error for the λt computation is incorporated when we consider a
large number of back-projected samples of a nowcasted series.

+ The complete routine is implemented in C++ and is already integrated with
R via the Rcpp package

---
class: hide_logo
background-image: url("fig/Logo_SUS.png")
background-size: 200px
background-position: 95% 5%


# Sistema Único de Saúde (SUS)

+ País continental
+ ~212 milhões de pessoas
+ Desigualdade e heterogeneidade, Sistema Federal (27 Estados)
+ Constitução Federal de 1988: __Sistema Único de Saúde__
+ Sistema __Universal, Público e Gratuito__
+ Unidades básicas de saúde, hospitais, rede de __Agentes Comunitários de Saúde (ACS)__ na frente de atenção ao público, rede de Unidades de Atenção Primária (UPA), hospitais + convênios com a rede privada de saúde
+ __Larga história de respostas efetivas pandemias/epidemias__. ZIKV em 2014, AIDS desde 1980.
+ Tradição de investigação em saúde pública e enfermedades tropicais (FIOCRUZ, Instituto Butantán) e __capacidade de produção de vacinas__ (CORONAVAC)
+ Um dos maiores programas de vacunação do mundo: +271.861.944 doses aplicadas desde  17 de Janeiro.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
